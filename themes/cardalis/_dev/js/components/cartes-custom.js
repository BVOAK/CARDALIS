
import Vue from 'vue';
import VueFormWizard from 'vue-form-wizard';
import vueSlider from 'vue-slider-component'
import 'vue-form-wizard/dist/vue-form-wizard.min.css';

Vue.use(VueFormWizard);

if($('#app-cartescustom').length ){
  gtag('event', 'conversion', {

    'send_to': 'AW-1069635118/f1eMCMX2tJMBEK6shf4D',

    'value': 0.0,

    'currency': 'EUR'

  });

}


const prices = {
  regular: {
    basePrice : {
      100: 209.17,
      200: 218.75,
      300: 228.33,
      400: 237.91,
      500: 247.49,
      1000: 316.15,
      2000: 490.83,
      3000: 676.04,
      4000: 827.30,
      5000: 933.80,
      7500: 1076.58,
      10000: 1260.90,
      15000: 1746.34,
      20000: 2235.84,
      30000: 3195.00,
      40000: 4154.16,
      50000: 4891.30,
      75000: 7138.59,
      100000: 9132.25
    },
    options : {
      metal :{
        100: 4.79,
        200: 4.79,
        300: 4.79,
        400: 4.79,
        500: 4.79,
        1000: 9.58,
        2000: 18.52,
        3000: 27.78,
        4000: 37.04,
        5000: 46.30,
        7500: 69.46,
        10000: 92.61,
        15000: 138.91,
        20000: 185.22,
        30000: 170.97,
        40000: 211.68,
        50000: 264.60,
        75000: 396.89,
        100000: 529.19
      },
      perso: {
        100: 11.98,
        200: 11.98,
        300: 11.98,
        400: 11.98,
        500: 11.98,
        1000: 23.95,
        2000: 46.30,
        3000: 69.46,
        4000: 92.61,
        5000: 115.76,
        7500: 173.64,
        10000: 231.52,
        15000: 347.28,
        20000: 463.04,
        30000: 641.14,
        40000: 793.79,
        50000: 992.24,
        75000: 1488.35,
        100000: 1984.47
      },
      ecriture: {
        100: 3.19,
        200: 3.19,
        300: 3.19,
        400: 3.19,
        500: 3.19,
        1000: 6.39,
        2000: 12.35,
        3000: 18.52,
        4000: 24.70,
        5000: 30.87,
        7500: 46.30,
        10000: 61.74,
        15000: 92.61,
        20000: 123.48,
        30000: 1068.56,
        40000: 1322.98,
        50000: 1653.73,
        75000: 2480.59,
        100000: 3307.45
      },
      magstripe_up:{
        100: 12.77,
        200: 12.77,
        300: 12.77,
        400: 12.77,
        500: 12.77,
        1000: 25.55,
        2000: 49.39,
        3000: 74.09,
        4000: 98.78,
        5000: 123.48,
        7500: 185.22,
        10000: 246.96,
        15000: 370.43,
        20000: 493.91,
        30000: 598.39,
        40000: 740.87,
        50000: 926.09,
        75000: 1289.91,
        100000: 1719.88
      },
      perforation: {
        100: 7.98,
        200: 7.98,
        300: 7.98,
        400: 7.98,
        500: 7.98,
        1000: 15.97,
        2000: 30.87,
        3000: 46.30,
        4000: 61.74,
        5000: 77.17,
        7500: 115.76,
        10000: 154.35,
        15000: 231.52,
        20000: 308.70,
        30000: 427.42,
        40000: 529.19,
        50000: 661.49,
        75000: 992.24,
        100000: 1322.98
      },
      overlay: {
        100: 28.74,
        200: 28.74,
        300: 28.74,
        400: 28.74,
        500: 28.74,
        1000: 57.48,
        2000: 111.13,
        3000: 166.70,
        4000: 222.26,
        5000: 277.83,
        7500: 416.74,
        10000: 555.65,
        15000: 833.48,
        20000: 1111.30,
        30000: 1538.73,
        40000: 1905.09,
        50000: 2381.37,
        75000: 3572.05,
        100000: 4762.73
      }

    },

  },
  rfid: {
    basePrice: {
      Mifare1K:{
        100: 248,
        200: 352,
        300: 451,
        400: 512,
        500: 557,
        1000: 801,
        2000: 1548,
        3000: 2278,
        4000: 2980,
        5000: 3348,
        6000: 4017,
        7000: 4687,
        8000: 5310,
        9000: 5974,
        10000: 5900,
        15000: 8217,
        20000: 10807,
        30000: 16211,
        40000: 21565,
        50000: 26209,
        75000: 38768,
        100000: 51570
      },
      Mifare1K7B: {
        100: 257,
        200: 367,
        300: 478,
        400: 548,
        500: 594,
        1000: 876,
        2000: 1693,
        3000: 2496,
        4000: 3270,
        5000: 3710,
        6000: 4452,
        7000: 5194,
        8000: 5890,
        9000: 6626,
        10000: 6569,
        15000: 9149,
        20000: 12050,
        30000: 18075,
        40000: 24050,
        50000: 29271,
        75000: 43297,
        100000: 57609
      },
      Mifare4K: {
        100: 278,
        200: 415,
        300: 550,
        400: 685,
        500: 812,
        1000: 1280,
        2000: 2475,
        3000: 3713,
        4000: 4893,
        5000: 5812,
        6000: 6974,
        7000: 8136,
        8000: 9252,
        9000: 10409,
        10000: 10047,
        15000: 13994,
        20000: 18509,
        30000: 27764,
        40000: 36969,
        50000: 44274,
        75000: 65489,
        100000: 87198
      },
      MifareUltralight512B: {
        100: 225,
        200: 250,
        300: 280,
        400: 332,
        500: 392,
        1000: 486,
        2000: 939,
        3000: 1409,
        4000: 1867,
        5000: 2188,
        6000: 2626,
        7000: 3064,
        8000: 3455,
        9000: 3887,
        10000: 3625,
        15000: 5050,
        20000: 6584,
        30000: 9876,
        40000: 13118,
        50000: 15493,
        75000: 22917,
        100000: 30435
      },
      MifareUltralightC: {
        100: 233,
        200: 262,
        300: 303,
        400: 374,
        500: 445,
        1000: 576,
        2000: 1113,
        3000: 1648,
        4000: 2197,
        5000: 2478,
        6000: 2974,
        7000: 3470,
        8000: 3919,
        9000: 4409,
        10000: 4161,
        15000: 5795,
        20000: 7578,
        30000: 11366,
        40000: 15106,
        50000: 17942,
        75000: 26540,
        100000: 35266
      },
      NTAG213: {
        100: 234,
        200: 265,
        300: 307,
        400: 380,
        500: 452,
        1000: 591,
        2000: 1142,
        3000: 1691,
        4000: 2255,
        5000: 2551,
        6000: 3061,
        7000: 3571,
        8000: 4035,
        9000: 4539,
        10000: 4294,
        15000: 5981,
        20000: 7826,
        30000: 11739,
        40000: 15602,
        50000: 18555,
        75000: 27446,
        100000: 36473
      },
      NTAG216: {
        100: 245,
        200: 286,
        300: 339,
        400: 422,
        500: 504,
        1000: 696,
        2000: 1345,
        3000: 1996,
        4000: 2661,
        5000: 2841,
        6000: 3409,
        7000: 3977,
        8000: 4499,
        9000: 5061,
        10000: 4829,
        15000: 6727,
        20000: 8820,
        30000: 13230,
        40000: 17590,
        50000: 21004,
        75000: 31069,
        100000: 41304
      },
      ICODESli2:{
        100: 225,
        200: 301,
        300: 375,
        400: 428,
        500: 482,
        1000: 636,
        2000: 1229,
        3000: 1822,
        4000: 2429,
        5000: 2768,
        6000: 3322,
        7000: 3875,
        8000: 4383,
        9000: 4930,
        10000: 4829,
        15000: 6727,
        20000: 8820,
        30000: 13230,
        40000: 17590,
        50000: 21004,
        75000: 31069,
        100000: 41304 
      },
      ICODES: {
        100: 240,
        200: 331,
        300: 420,
        400: 476,
        500: 534,
        1000: 756,
        2000: 1461,
        3000: 2148,
        4000: 2864,
        5000: 3348,
        6000: 4017,
        7000: 4687,
        8000: 5310,
        9000: 5974,
        10000: 5900,
        15000: 8217,
        20000: 10807,
        30000: 16211,
        40000: 21565,
        50000: 25903,
        75000: 38315,
        100000: 50966
      },
      TK4100: {
        100: 225,
        200: 256,
        300: 286,
        400: 317,
        500: 347,
        1000: 379,
        2000: 733,
        3000: 1096,
        4000: 1461,
        5000: 1565,
        6000: 1878,
        7000: 2191,
        8000: 2458,
        9000: 2765,
        10000: 2662,
        15000: 3708,
        20000: 4795,
        30000: 7193,
        40000: 9540,
        50000: 11084,
        75000: 16395,
        100000: 21739 
      },
      EM4200: {
        100: 228,
        200: 262,
        300: 321,
        400: 380,
        500: 437,
        1000: 531,
        2000: 1026,
        3000: 1496,
        4000: 1994,
        5000: 2188,
        6000: 2626,
        7000: 3064,
        8000: 3455,
        9000: 3887,
        10000: 3759,
        15000: 5236,
        20000: 6832,
        30000: 10248,
        40000: 13615,
        50000: 16105,
        75000: 23822,
        100000: 31643
      },
      EM4550: {
        100: 363,
        200: 577,
        300: 788,
        400: 1003,
        500: 1217,
        1000: 2135,
        2000: 4070,
        3000: 6017,
        4000: 7965,
        5000: 9870,
        6000: 11843,
        7000: 13817,
        8000: 15745,
        9000: 17583,
        10000: 17940,
        15000: 24801,
        20000: 32671,
        30000: 49006,
        40000: 64298,
        50000: 78567,
        75000: 114402,
        100000: 150000
      },
      UHFGEN2: {
        100: 236,
        200: 268,
        300: 312,
        400: 386,
        500: 460,
        1000: 606,
        2000: 1171,
        3000: 1626,
        4000: 2168,
        5000: 2333,
        6000: 2800,
        7000: 3267,
        8000: 3687,
        9000: 4148,
        10000: 4161,
        15000: 5795,
        20000: 7578,
        30000: 11366,
        40000: 15106,
        50000: 17330,
        75000: 25634,
        100000: 34058
      },
      UHFGEN2Encoded: {
        100: 255,
        200: 361,
        300: 465,
        400: 572,
        500: 624,
        1000: 876,
        2000: 1693,
        3000: 2365,
        4000: 3154,
        5000: 3493,
        6000: 4191,
        7000: 4890,
        8000: 5542,
        9000: 6235,
        10000: 6301,
        15000: 8776,
        20000: 11553,
        30000: 16957,
        40000: 22559,
        50000: 26516,
        75000: 39221,
        100000: 50966
      },
      D21: {
        100: 327,
        200: 538,
        300: 748,
        400: 961,
        500: 1164,
        1000: 1895,
        2000: 3664,
        3000: 5061,
        4000: 6458,
        5000: 7551,
        6000: 9061,
        7000: 10571,
        8000: 12035,
        9000: 13539,
        10000: 12990,
        15000: 18093,
        20000: 23478,
        30000: 35217,
        40000: 46907,
        50000: 57134,
        75000: 84511,
        100000: 112560
      },
      D41: {
        100: 377,
        200: 604,
        300: 829,
        400: 1057,
        500: 1284,
        1000: 2120,
        2000: 4099,
        3000: 5713,
        4000: 7038,
        5000: 8420,
        6000: 10104,
        7000: 11788,
        8000: 13426,
        9000: 15104,
        10000: 14595,
        15000: 20329,
        20000: 25714,
        30000: 38571,
        40000: 51379,
        50000: 62645,
        75000: 92663,
        100000: 123430
      },
      D81: {
        100: 401,
        200: 652,
        300: 901,
        400: 1153,
        500: 1404,
        1000: 2375,
        2000: 4533,
        3000: 6061,
        4000: 7907,
        5000: 9797,
        6000: 11757,
        7000: 13716,
        8000: 15629,
        9000: 17583,
        10000: 17538,
        15000: 24429,
        20000: 32422,
        30000: 48634,
        40000: 64795,
        50000: 78567,
        75000: 116214,
        100000: 154831
      },
      MifarePlusX2K: {
        100: 312,
        200: 508,
        300: 703,
        400: 901,
        500: 1089,
        1000: 1745,
        2000: 3374,
        3000: 4626,
        4000: 5878,
        5000: 6826,
        6000: 8191,
        7000: 9557,
        8000: 10875,
        9000: 12235,
        10000: 11652,
        15000: 16230,
        20000: 20994,
        30000: 31491,
        40000: 41938,
        50000: 51010,
        75000: 75453,
        100000: 100483
      },
      MifarePlusX4K: {
        100: 333,
        200: 550,
        300: 766,
        400: 985,
        500: 1194,
        1000: 1955,
        2000: 3780,
        3000: 5235,
        4000: 6690,
        5000: 7841,
        6000: 9409,
        7000: 10977,
        8000: 12499,
        9000: 14061,
        10000: 13525,
        15000: 18839,
        20000: 24472,
        30000: 36708,
        40000: 48894,
        50000: 59584,
        75000: 88134,
        100000: 117391
      },
      MifarePlusS4K: {
        100: 327,
        200: 538,
        300: 748,
        400: 961,
        500: 1164,
        1000: 1895,
        2000: 3664,
        3000: 5061,
        4000: 6458,
        5000: 7551,
        6000: 9061,
        7000: 10571,
        8000: 12035,
        9000: 13539,
        10000: 12990,
        15000: 18093,
        20000: 23478,
        30000: 35217,
        40000: 46907,
        50000: 57134,
        75000: 84511,
        100000: 112560
      }
    },
    options: {
      perso: {
        100: 2,
        200: 4,
        300: 7,
        400: 9,
        500: 11,
        1000: 22,
        2000: 43,
        3000: 65,
        4000: 87,
        5000: 109,
        6000: 130,
        7000: 152,
        8000: 174,
        9000: 196,
        10000: 201,
        15000: 280,
        20000: 373,
        30000: 559,
        40000: 745,
        50000: 919,
        75000: 1359,
        100000: 1812
      },
      ecriture: {
        100: 15,
        200: 15,
        300: 15,
        400: 15,
        500: 15,
        1000: 15,
        2000: 29,
        3000: 43,
        4000: 58,
        5000: 72,
        6000: 87,
        7000: 101,
        8000: 116,
        9000: 130,
        10000: 134,
        15000: 186,
        20000: 248,
        30000: 373,
        40000: 497,
        50000: 612,
        75000: 906,
        100000: 1208
      },
      magstripe_up:{
        100: 45,
        200: 45,
        300: 45,
        400: 45,
        500: 45,
        1000: 45,
        2000: 87,
        3000: 130,
        4000: 174,
        5000: 217,
        6000: 261,
        7000: 304,
        8000: 348,
        9000: 391,
        10000: 401,
        15000: 559,
        20000: 745,
        30000: 1118,
        40000: 1491,
        50000: 1837,
        75000: 2717,
        100000: 3623
      },
      perforation:{
        100: 30,
        200: 30,
        300: 30,
        400: 30,
        500: 30,
        1000: 30,
        2000: 58,
        3000: 87,
        4000: 116,
        5000: 145,
        6000: 174,
        7000: 203,
        8000: 232,
        9000: 261,
        10000: 268,
        15000: 373,
        20000: 497,
        30000: 745,
        40000: 994,
        50000: 1225,
        75000: 1812,
        100000: 2415
      },
      overlay:{
        100: 54,
        200: 54,
        300: 54,
        400: 54,
        500: 54,
        1000: 54,
        2000: 104,
        3000: 157,
        4000: 209,
        5000: 261,
        6000: 313,
        7000: 365,
        8000: 417,
        9000: 470,
        10000: 482,
        15000: 671,
        20000: 894,
        30000: 1342,
        40000: 1789,
        50000: 2205,
        75000: 3261,
        100000: 4348
      },
      printuid:{
        100: 15,
        200: 15,
        300: 15,
        400: 15,
        500: 15,
        1000: 15,
        2000: 29,
        3000: 43,
        4000: 58,
        5000: 72,
        6000: 87,
        7000: 101,
        8000: 116,
        9000: 130,
        10000: 134,
        15000: 186,
        20000: 248,
        30000: 373,
        40000: 497,
        50000: 612,
        75000: 906,
        100000: 1208
      },
      encoding:{
        100: 22,
        200: 22,
        300: 22,
        400: 22,
        500: 22,
        1000: 22,
        2000: 43,
        3000: 65,
        4000: 87,
        5000: 109,
        6000: 130,
        7000: 152,
        8000: 174,
        9000: 196,
        10000: 201,
        15000: 280,
        20000: 373,
        30000: 559,
        40000: 745,
        50000: 919,
        75000: 1359,
        100000: 1812
      }
    }
  }
}

const rfidChips = [
  {
    name: 'Mifare 1K Classic (NXP) 4 bytes NUID',
    id: 'Mifare1K'
  },
  {
    name: 'Mifare 1K Classic (NXP) 7 bytes UID',
    id: 'Mifare1K7B'
  },
  {
    name: 'Mifare 4K (NXP) 4 bytes NUID',
    id: 'Mifare4K'
  },
  {
    name: 'Mifare Ultralight NXP (512 bytes)',
    id: 'MifareUltralight512B'
  },
  {
    name: 'Mifare Ultralight C NXP (Type C)',
    id: 'MifareUltralightC'
  },
  {
    name: 'NTAG213 NXP',
    id: 'NTAG213'
  },
  {
    name: 'NTAG216 NXP',
    id: 'NTAG216'
  },
  {
    name: 'ICODE Sli2 / SliX (NXP)',
    id: 'ICODESli2'
  },
  {
    name: 'ICODE S (NXP)',
    id: 'ICODES'
  },
  {
    name: '125khz r/o TK4100',
    id: 'TK4100'
  },
  {
    name: 'EM4200/EM4102',
    id: 'EM4200'
  },
  {
    name: '125khz r/w EM4550',
    id: 'EM4550'
  },
  {
    name: 'UHF GEN2 (Non Encodé)',
    id: 'UHFGEN2'
  },
  {
    name: 'UHF GEN2 (EPC Encodé)',
    id: 'UHFGEN2Encoded'
  },
  {
    name: 'Desfire 2K (EV1 D21)',
    id: 'D21'
  },
  {
    name: 'Desfire 4K (EV1 D41)',
    id: 'D41'
  },
  {
    name: 'Desfire 8K (EV1 D81)',
    id: 'D81'
  },
  {
    name: 'Mifare PLUS X 2k',
    id: 'MifarePlusX2K'
  },
  {
    name: 'Mifare PLUS X 4k',
    id: 'MifarePlusX4K'
  },
  {
    name: 'Mifare PLUS S 4k',
    id: 'MifarePlusS4K'
  }
];



if(document.getElementById('app-cartescustom') != null){
  let app = new Vue({
      el: document.getElementById('app-cartescustom'),
      components: {
          vueSlider
      },
      data: {
          puce: false,
          puceTypes: rfidChips,
          puceTypeSelected: 'Mifare1K',
          perso: false,
          ecriture: false,
          magstripe: 'no',
          perforation: false,
          overlay: false,
          printuid: false,
          encoding: false,
          metal:false,
          qte:100,
          email:null,
          contactback:false,
          numtel:null,
          emailShow:false,
          qteOptionsRegular: {
              min:100,
              max: 100000,
              data: [
                  100,
                  200,
                  300,
                  400,
                  500,
                  1000,
                  2000,
                  3000,
                  4000,
                  5000,
                  7500,
                  10000,
                  15000,
                  20000,
                  30000,
                  40000,
                  50000,
                  75000,
                  100000
              ]
          },
          qteOptionsRfid: {
              min:100,
              max: 100000,
              data: [
                  100,
                  200,
                  300,
                  400,
                  500,
                  1000,
                  2000,
                  3000,
                  4000,
                  5000,
                  6000,
                  7000,
                  8000,
                  9000,
                  10000,
                  15000,
                  20000,
                  30000,
                  40000,
                  50000,
                  75000,
                  100000
              ]
          }

      },
      computed: {
          total:  function(){
              let price=0;
              let tableau=null;
              let carte = null;
              if(this.puce == true){
                  tableau = prices.rfid;
                  carte = tableau.basePrice[this.puceTypeSelected];
              }else {
                  tableau = prices.regular;
                  carte = tableau.basePrice;
              }
              console.log(tableau, carte);
              price +=carte[this.qte];
              //Options

              if(this.perso==true){
                  price+=tableau.options.perso[this.qte];
              }
              if(this.ecriture==true){
                  price+=tableau.options.ecriture[this.qte];
              }
              if(this.magstripe!='no'){
                  price+=tableau.options['magstripe_'+this.magstripe][this.qte];
              }
              if(this.perforation==true){
                  price+=tableau.options.perforation[this.qte];
              }
              if(this.overlay==true){
                  price+=tableau.options.overlay[this.qte];
              }
              if(this.printuid==true){
                  price+=tableau.options.printuid[this.qte];
              }
              if(this.encoding==true){
                  price+=tableau.options.encoding[this.qte];
              }
              if(this.metal==true){
                  price+=tableau.options.metal[this.qte];
              }


              return (Math.round(price*100)/100).toString().replace('.',',');
          }

      },

      methods: {


          onOptionsDisplayed :function(){
              this.emailShow=true;

              this.$nextTick(() => {


                  this.$nextTick(() => {
                      $('#g-recaptcha').parent().removeClass('offset-md-3');
                      grecaptcha.render('g-recaptcha', {
                          'sitekey' : $('#g-recaptcha').data('sitekey')
                      });
                  })
              })

          },
          send: function(e){
              e.preventDefault();
              e.stopPropagation();
              let form = document.getElementById('contactCartesPerso');
              let url = form.getAttribute('action');
              let method = form.getAttribute('method');
              let pucename = null;
              if(this.puce){
                  rfidChips.forEach(element => {
                      if(element.id==this.puceTypeSelected){
                          pucename=element.name;
                      }
                  });
              }
              let magstripestring = null;
              if(this.magstripe=='no') magstripestring="Non";
              if(this.magstripe=='up') magstripestring="Oui";


              var message = 'RFID : '+((this.puce)?'Oui':'Non')+'\n'+
                  ((pucename!=null)?('Puce : '+pucename+'\n'):'')+
                  'Quantité : '+this.qte+'\n'+
                  'Personnalisation : '+((this.perso)?'Oui':'Non')+'\n'+
                  'Ecriture : '+((this.ecriture)?'Oui':'Non')+'\n'+
                  'Bande Magnétique : '+magstripestring+'\n'+
                  'Perforation : '+((this.perforation)?'Oui':'Non')+'\n'+
                  'Overlay : '+((this.overlay)?'Oui':'Non')+'\n';

              if(this.puce){
                  message +=  'Print/Lecture UID : '+((this.printuid)?'Oui':'Non')+'\n'+
                      'Encodage : '+((this.encoding)?'Oui':'Non')+'\n';
              }
              else{
                  message += 'Couleur métalique : '+((this.metal)?'Oui':'Non')+'\n';
              }


              message += 'Total : '+this.total+'€\n\n';
              message += 'Je souhaite être contacté : '+((this.contactback)?'Oui':'Non')+'\n';
              if(this.contactback){
                  message += 'Téléphone : '+this.numtel+'\n';
                  message += 'Email : '+this.email+'\n';
              }

              document.getElementById('message').value=message;

              var data = $('#contactCartesPerso').serialize()+'&submitMessage=true';
              $.ajax({
                  type:method,
                  url: url,
                  data: data,
                  success:function(data){
                      var previousText = $('#contactCartesPerso').find('#submitButton').val();
                      $('#contactCartesPerso').find('#submitButton').addClass('sent').val('Demande envoyée ;-)');
                      gtag('event', 'conversion', {
                          'send_to': 'AW-1069635118/f1eMCMX2tJMBEK6shf4D',
                          'value': this.total,
                          'currency': 'EUR',
                      });
                      setTimeout(function(){
                          $('#contactCartesPerso').find('#submitButton').removeClass('sent').val(previousText);
                      }, 10000);
                  }
              })


          }

      }

  })
}
